<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

	<link href="https://fonts.googleapis.com/css?family=Jua&display=swap" rel="stylesheet">

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">

	<title>FITOME, 헤어스타일 추천받기</title>
	<link rel="stylesheet" href="style.css">
	<!-- Go to www.addthis.com/dashboard to customize your tools -->
	<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e8a5a09f987b112"></script>

</head>

<body>
	<nav class="p-3 container navbar navbar-expand-lg navbar-light">
		<a class="navbar-brand" href="https://agitated-wozniak-7a7258.netlify.com/">FITOME</a>
	</nav>
	<section class="section">
		<h1 class="title">FITOME가 추천하는 나의 머리 스타일</h1>
		<h2 class="subtitle">내 얼굴형에 어울리는 헤어는 무엇일까?</h2>
	</section>
	<section class="black">
		<div class="pr-5 black_cover">
			<h3 class="pt-3 pb-3 black_author">Made By DaeLee 데리</h3>
		</div>
	</section>

	<h3 class="pb-2 pt-2 choose_gender">성별을 선택하세요</h3>
	<section class="d-flex justify-content-center">
		<p class="d-flex align-items-center pr-3 gender_female">여자</p>
		<div class="pt-2 pb-3 div_knob">
			<input type="checkbox" id="gender">
			<label for="gender">
				<span class="knob">
					<i></i>
				</span>
			</label>
		</div>
		<p class="d-flex align-items-center pl-3 gender_male">남자</p>
	</section>

	<script class="jsbin" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

	<div class="container file-upload">
		<div class="image-upload-wrap">
			<input class="file-upload-input" type='file' onchange="readURL(this);" accept="image/*" />
			<div class="drag-text">
				<img src="img/down.png" class="mt-5 pt-3 upload">
				<h3 class="mb-5 pb-5 pt-4 upload-text">얼굴 사진을 올려놓거나 눌러서 업로드하세요~!</h3>
			</div>
		</div>
		<div class="file-upload-content">
			<img class="file-upload-image" id="face_image" src="#" alt="your image" />
			<div id="loading" class="animated bounce">
				<div class="spinner-grow" role="status">
					<span class="sr-only">Loading...</span>
				</div>
				<p class="text-center">AI가 당신의 헤어스타일을 분석중입니다.</p>
			</div>
			<p class="result-message"></p>
			<div id="label-container" class="d-flex flex-column justify-content-around"></div>

			<!-- Go to www.addthis.com/dashboard to customize your tools -->
			<div class="addthis_inline_share_toolbox_jdj8"></div>

			<div class="pt-3 image-title-wrap">
				<button type="button p-2" onclick="window.location.reload()" class="try-again-btn">
					<span class="try-again-text">다른 사진으로 재시도</span>
				</button>
			</div>
		</div>
	</div>

	<footer class="footer pt-5 container d-flex justify-content-center">
		<div>
			<p>&copy; 이기상 2020. All Rights Reserved. </p>
			<ul class="list-inline d-flex justify-content-center">
			</ul>
		</div>
	</footer>

	<!-- Optional JavaScript -->
	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
	<script>
		function readURL(input) {
			if (input.files && input.files[0]) {
				var reader = new FileReader();
				reader.onload = function(e) {
					$('.image-upload-wrap').hide();
					$('.file-upload-image').attr('src', e.target.result);
					$('.file-upload-content').show();
					$('.image-title').html(input.files[0].name);
				};
				reader.readAsDataURL(input.files[0]);
				init().then(() => {
					console.log("hello")
					predict();
					$('#loading').hide();
				});
			} else {
				removeUpload();
			}
		}

		function removeUpload() {
			$('.file-upload-input').replaceWith($('.file-upload-input').clone());
			$('.file-upload-content').hide();
			$('.image-upload-wrap').show();
		}
		$('.image-upload-wrap').bind('dragover', function() {
			$('.image-upload-wrap').addClass('image-dropping');
		});
		$('.image-upload-wrap').bind('dragleave', function() {
			$('.image-upload-wrap').removeClass('image-dropping');
		});
	</script>
	<script type="text/javascript">
		let URL;
		// More API functions here:
		// https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image
		// the link to your model provided by Teachable Machine export panel
		const urlfemale = "https://teachablemachine.withgoogle.com/models/PM9MZX_Cc/";
		const urlmale = "https://teachablemachine.withgoogle.com/models/dyQadpeQN/";
		let model, webcam, labelContainer, maxPredictions;
		// Load the image model and setup the webcam
		async function init() {
			if (document.getElementById("gender").checked) {
				URL = urlmale;
				console.log("male")
			} else {
				URL = urlfemale;
				console.log("female")
			}
			const modelURL = URL + "model.json";
			const metadataURL = URL + "metadata.json";
			// load the model and metadata
			// Refer to tmImage.loadFromFiles() in the API to support files from a file picker
			// or files from your local hard drive
			// Note: the pose library adds "tmImage" object to your window (window.tmImage)
			model = await tmImage.load(modelURL, metadataURL);
			maxPredictions = model.getTotalClasses();
			labelContainer = document.getElementById("label-container");
			for (let i = 0; i < maxPredictions; i++) { // and class labels
				var element = document.createElement("div")
				element.classList.add("d-flex");
				labelContainer.appendChild(element);
			}
		}
		// run the webcam image through the image model
		async function predict() {
			// predict can take in an image, video or canvas html element
			var image = document.getElementById("face_image")
			const prediction = await model.predict(image, false);
			prediction.sort((a, b) => parseFloat(b.probability) - parseFloat(a.probability));
			var resultTitle, resultExplain, resultCeleb;
			if (document.getElementById("gender").checked) {
				switch (prediction[0].className) {
					case "egg":
						resultTitle = "댤걀같은 내 얼굴 계란형"
						resultExplain = "당신은 축복받은 얼굴을 타고났군요! 본인이 생각하기에 적당한 스타일로 시도해보세요! 뭘 해도 실패할 확률이 낮거든요~<br>&ast;피해야할 스타일: 굳이 따지면 얼굴형을 가리는 앞머리?"
						resultCeleb = "계란형 연예인: 윤계상, 정해인"
						break;
					case "long":
						resultTitle = "시원시원 길쭉한 긴 얼굴형"
						resultExplain = "윗머리를 길지 않게 볼륨을 적게! 측면은 짧지 않은 리젠트 OR 포마드 아니면 가르마펌 어때요~?<br>&ast;피해야할 스타일: 투블럭은 NO! 옆머리가 짧으면 더 길어보일 수 있어요."
						resultCeleb = "긴 얼굴형 연예인: 소지섭, 이종석, 존박"
						break;
					case "circle":
						resultTitle = "동글동글 보름달 둥근형"
						resultExplain = "평범하면서 인상이 좋은 얼굴형을 보유하고 계시군요! 드러낸 이마, 앞/윗머리 볼륨, 옆가르마, 각진 스타일 등으로 다양한 연출을 해보세요!<br>&ast;피해야할 스타일: 긴 앞머리와 옆머리, 앞 가르마!"
						resultCeleb = "둥근형 연예인: 송중기, 조정석"
						break;
					case "diamond":
						resultTitle = "보석같은 내 얼굴 다이아몬드형"
						resultExplain = "넓은 광대와 각진 턱이 포인트네요! 긴머리, 펌, 적당한 옆머리로 얼굴선을 부드럽게 만들어보는 건 어떨까요~?<br>&ast;피해야할 스타일: 직모, 광대를 부각시키는 아주 짧은 옆머리!!"
						resultCeleb = "다이아몬드형 연예인: 김우빈"
						break;
					case "square":
						resultTitle = "진정한 매력쟁이~! 각진형"
						resultExplain = "남성적인 매력이 넘치는 분이시군요! 짧은 커트, 짧은 옆머리, 윗머리 볼륨, 올린 앞머리 등으로 최대한 부드러운 이미지를 표현하세요!<br>&ast;피해야할 스타일: 앞 가르마, 무거운 앞머리, 얼굴을 넓히는 옆머리"
						resultCeleb = "각진형 연예인: 박서준, 여진구"
						break;
					default:
						resultTitle = "알수없음"
						resultExplain = ""
						resultCeleb = ""
				}
			} else {
				switch (prediction[0].className) {
					case "egg":
						resultTitle = "달걀같은 내 얼굴 계란형"
						resultExplain = "갸름한 얼굴형을 잘 보여줄 수 있는 포니테일~!, 컬이 들어간 레이어드 S컬펌이 잘 어울릴 것같아요~!<br>&ast;피해야할 스타일: 이마를 가리는 무거운 느낌의 뱅"
						resultCeleb = "계란형 연예인: 수지, 신세경, 전지현, 한예슬"
						break;
					case "long":
						resultTitle = "시원시원 길쭉한 긴 얼굴형"
						resultExplain = "옆머리에 볼륨감을 준 미디엄 롱기장의 루즈한 S컬, 5:5 정가르마, 눈썹에 닿는 시스루 뱅 어떠세요~?<br>&ast;피해야할 스타일: 턱선까지 오는 기장, 딱 붙는 머리"
						resultCeleb = "긴 얼굴형 연예인: 려원, 로제, 백예린, 선미"
						break;
					case "circle":
						resultTitle = "동글동글 보름달 둥근형"
						resultExplain = "시각적으로 갸름하게 보여주는 레이어드 C컬펌, 뿌리볼륨펌, 턱선까지 오거나 미디엄보다 긴 기장을 추천~!<br>&ast;피해야할 스타일: 미디엄 기장의 머리"
						resultCeleb = "둥근형 연예인: 고현정, 신민아, 유이, 프리스틴 나영"
						break;
					case "square":
						resultTitle = "진정한 매력쟁이~! 네모형"
						resultExplain = "단발 굵은 S컬펌, 미디엄 길이 레이어드 C컬펌, 애교머리에 자연스럽게 웨이브를 준 스타일이 좋아보여요~!<br>&ast;피해야할 스타일: 스트레이트 매직"
						resultCeleb = "네모형 연예인: 김혜수, 블랙핑크 제니, 정유미, 한효주"
						break;
					case "diamond":
						resultTitle = "보석같은 내 얼굴 다이아몬드형"
						resultExplain = "앞머리 위쪽에 풍성한 볼륨감을 준 자연스러운 웨이브 스타일의 여신 앞머리를 해보세요!<br>&ast;피해야할 스타일: 대부분 스타일이 잘 어울리는 편이시네요!"
						resultCeleb = "다이아몬드형 연예인: 김하늘"
						break;
					default:
						resultTitle = "알수없음"
						resultExplain = ""
						resultCeleb = ""
				}
			}
			var title = "<div class='" + prediction[0].className + "-animal-title'>" + resultTitle + "</div>"
			var explain = "<div class='animal-explain pt-2'>" + resultExplain + "</div>"
			var celeb = "<div class='" + prediction[0].className + "-animal-celeb pt-2 pb-2'>" + resultCeleb + "</div>"
			$('.result-message').html(title + explain + celeb);
			var barWidth;
			for (let i = 0; i < maxPredictions; i++) {
				if (prediction[i].probability.toFixed(2) > 0.1) {
					barWidth = Math.round(prediction[i].probability.toFixed(2) * 100) + "%";
				} else if (prediction[i].probability.toFixed(2) >= 0.01) {
					barWidth = "4%"
				} else {
					barWidth = "2%"
				}
				var labelTitle;
				switch (prediction[i].className) {
					case "egg":
						labelTitle = "계란형"
						break;
					case "long":
						labelTitle = "긴얼굴형"
						break;
					case "circle":
						labelTitle = "동글형"
						break;
					case "square":
						labelTitle = "네모형"
						break;
					case "diamond":
						labelTitle = "다이아몬드형"
						break;
					default:
						labelTitle = "알수없음"
				}
				var label = "<div class='animal-label d-flex align-items-center'>" + labelTitle + "</div>"
				var bar = "<div class='bar-container position-relative container'><div class='" + prediction[i].className + "-box'></div><div class='d-flex justify-content-center align-items-center " + prediction[i].className + "-bar' style='width: " + barWidth + "'><span class='d-block percent-text'>" + Math.round(prediction[i].probability.toFixed(2) * 100) + "%</span></div></div>"
				labelContainer.childNodes[i].innerHTML = label + bar;
			}
		}
	</script>
</body>

<!--Copyright (c) 2020 by Aaron Vanston (https://codepen.io/aaronvanston/pen/yNYOXR)

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

Copyright (c) 2020 by Mert Cukuren (https://codepen.io/knyttneve/pen/bPpEZY)

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


-->

</html>